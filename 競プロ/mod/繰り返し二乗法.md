# 繰り返し二乗法とは

次のような問題を解くときに使える高速なアルゴリズム。

### 例題

整数 N , M , Pが与えられる。  
N の P乗を M で割ったあまりを求めよ。  
※ただしPは結構大きい可能性がある

問題リンク：[ATC002-B](https://atcoder.jp/contests/atc002/tasks/atc002_b)



## 解説

リンク先にもあるが，自分でしっかり理解するために解説する。  

最初に思いつくのが,愚直にNのP乗を計算してからMODのあまりを取る方法。  
しかしこれだと非常に大きな数N^Pを一度扱うことになり，必要以上の実行時間がかかる。  

そこで使えるアルゴリズムが「繰り返し二乗法」  

---

例えばP=16のとき，  
1. n^2を計算
2. n^4 = n^2 * n^2
3. n^8 = n^4 * n^4
4. n^16 = n^8 * n^8  

このようにすると，たった4回でn^16を手に入れることができる。このように手に入れた自乗の数値を使うのが効率が良い。  
これを一般化してみる。

---
