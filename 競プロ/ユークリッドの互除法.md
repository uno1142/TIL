# ユークリッドの互除法

[mod 1000000007で割ったあまりを求める](https://github.com/uno1142/TIL/blob/master/%E7%AB%B6%E3%83%97%E3%83%AD/1000000007.md)に関して，拡張ユークリッドの互除法を用いることがある．  
逆元を求めるのにこの方法が便利だからである．

## ユークリッドの互除法とは

`a を b で割った商を q，余りを r とおくと`    

`a=bq+r`

このとき，

`gcd(a,b)=gcd(b,r)`  

が成り立つ

##### ※gcd
gcdは最大(greatest) 公(common) 約数(divisor) の略.


## ユークリッドの互除法の活用

### 一次不定方程式への応用

例  
`8x + 11 y = 0`を満たす`(x,y)`を求める  

11と8にユークリッドの互除法を適用

11 = 8 * 1 + 3...①  
8 = 3 * 2 + 2...②  
3 = 2 * 1 + 1...③  

※1をax + by の形で表していく  
③より 1 = 3 - 2 * 1
②より   = 3 - (8 - 3 * 2) * 1  
        = 3 * 3 + 8 * (-1)  
①より    = (11 - 8 * 1) * 3  -8  
        = 8 * (-4) + 11 * 3
        = 8 * (-4) + 11 * 3  
        
これは8x + 11y = 1の形になっているので，(-4,3)が解のひとつ．　　
一般解は，(-4 + 11n , 3 - 8n)(nは整数)

## 拡張ユークリッドの互除法による逆元計算

拡張ユークリッドの互除法とは，以下のことができるアルゴリズムである。  
____

互いに素な2整数a,bが与えられたときに  
<br>
ax + by = 1  
<br>
を満たす(x,y)を1つ求める
____


### 実装
```
#include<bits/stdc++.h>
using namespace std;

long long modinv(long long a, long long m){ //引数は(逆元を求める数，mod)
  long long b = m, u = 1, v = 0;
  while(b){
    long long t = a / b;
    a -= t * b; swap(a,b);
    u -= t * v; swap(a,b);
  }
  u %= m;
  if(u < 0)u += m;
  return u;
}

```

> 逆元おぼえがき:「値aにかけてからmodで割るとあまりが1になるようなbを，aの逆元」ということだと解釈した． 例 2(mod13)→ 2 * b = 1(mod 13) bが7の時，14 ≡ 1(mod 13)より，2の逆元は7(mod 13) 
